// Generated by CoffeeScript 1.4.0
(function() {
  var fs, path, requirejs;

  requirejs = require("requirejs");

  path = require("path");

  fs = require("fs");

  module.exports = function(grunt) {
    var config, helpers, min;
    min = {};
    config = grunt.config.get("global");
    helpers = config.helpers;
    grunt.registerTask("js:compile", function() {
      var global_config, require;
      require = grunt.config.get("js").require;
      global_config = grunt.config.get("global");
      grunt.log.writeln("requriejs optimizing...");
      requirejs.optimize(require);
      return grunt.file.copy(require.out, require.out, {
        process: function(fileContents) {
          return fileContents.replace(/__version__/, "\"" + global_config.ver.official + "\"");
        }
      });
    });
    grunt.registerTask("js:cleanup", "compile and minify the js", function() {
      var require;
      require = grunt.config.get("js").require;
      return fs.unlink(require.out);
    });
    return grunt.registerTask("js", "config:async js:compile concat:js min js:cleanup");
  };

}).call(this);
